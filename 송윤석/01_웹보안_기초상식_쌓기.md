# 01 웹보안 기초상식 쌓기 part.01

보안/웹 트랙 활동을 위해 사전 스터디를 시작하려 했는데 `인증/인가 처리 미흡`, `JWT, 세션 처리 취약점`, `입력값 검증 부족`, `CORS 설정 오류`, `CSRF 대응 미비`, `보안 Header 설정 미흡`, `로그 관리 실수`, `환경변수 관리 문제` 등의 주제가 있는 것을 보게 되었다.

이들 중 몇몇은 기존에 알고 있었지만, 정확히는 몰랐고, `CSRF`, `보안 Header`등은 처음 들어본 말들이였다. 

그래서 이 기회에 각각이 무엇인지, 어떤 부분을 조심해야 하는지 알아보고자 한다. 전부 하루에 알아보기엔 너무 많으므로, 2일로 나누어 알아보고, 기존 프로젝트도 분석해보고자 한다.


## 1. 인증/인가 처리 미흡

> 참고자료
> - https://studysteadily.tistory.com/47
> - https://velog.io/@serious56/%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80-%EC%B7%A8%EC%95%BD%EC%A0%90

**인증/인가 처리 미흡**은 인증이 필요한 페이지에 인증처리 소스코드 로직의 결함으로 인해 공격자가 적절한 인증처리를 수행하지 않고  중요한 자원(관리자 페이지, 내부 게시판, 기밀 데이터 등)에 접근할 수 있게 되는 취약점이다. 

### 인증 취약점

세션 쿠키 설정이 미흡한 경우 인증 정보를 탈취당할 수 있다. 이는 `JWT, 세션 처리 취약점`의 내용인 것 같다. 쿠키는 클라이언트에 저장되므로, 공격자가 자바스크립트 등을 이용해 쉽게 탈취할 수 있다. 그러므로 저장할 때 `http-only`나 `Secure`등의 옵션을 적용해 세션/쿠키를 지켜야 한다.

다음으로, **프로세스 건너뛰기**가 있다. 회원가입이나 본인인증 절차가 (1)약관 동의 → (2)본인인증 → (3)회원가입 순서로 진행되는데, URL 조작으로 (2)를 건너뛰고 직접 (3)페이지에 접근할 수 있는 경우가 있다. 인증 로직이 서버에서 단단히 체크되지 않으면, 간단한 URL 변조만으로 절차를 우회할 수도 있다.

게시글 번호나 사용자 ID등 웹서버로 전송되는 모든 HTTP 요청 값(URL Parameter, Cookie, Referer, form 변수, hidden 필드, User-Agent 등)을 조작하여 정상적으로는 접근 권한이 없는 정보를 조회/변경하는 공격이 있다. 이를 **파라미터 변조**라고 한다. 인증·인가 로직이 URL 파라미터에만 의존하고 별도의 서버 검증이 없다면, 공격이 성립되므로, 꼭 서버측에서 검증을 해야 한다.
 
인증 횟수에 제한을 하지 않은 경우도 있다. 이 경우 **브루트-포스 공격(무차별 대입)**이 가능해진다. 브루트-포스 공격 관련해서 찾아보다 얼마전 벨로그에서 봤던 한 글이 생각났다. [클라이언트측 보안은 절대로 깨진다](https://velog.io/@parallelkim/client-decryption)라는 글이다. 이 글에선 국내 모 금융 서비스에서 거래내역서를 받아보았는데, 비밀번호가 걸린 HTML을 받았고, 그 비밀번호 검증이 클라이언트 측에서 이루어지며, 횟수제한이 없다는 것을 발견했다. 그래서 즉시 브루트-포스 스크립트를 짜서 약 30초 만에 원본 내용을 확인했다는 내용이였다.


### 인가 취약점

공격자가 관리자로 로그인하지 않은 상태에서 관리자 페이지의 URL을 직접 입력하거나, 약관 동의  절차 중 특정 페이지의 URL을 알고 그 페이지로 이동하여 절차를 점프하는 경우가 있다. 이를 **URL 직접 접근**이라 한다. 사이트 내부 관리 페이지는 `/admin`, `/manage` 같은 특정 규칙을 가지므로 URL을 예측해서 접근을 시도한다.

위 예시중 하나로, 관리자 전용 페이지가 여로 경로로 나누어져 있고, 특정 경로에는 권한 체크 로직을 생략한 경우도 있다.

**주석, CSS를 통해 접근 제한**을 해놓거나, **자바스크립트만으로 막아놓아** 취약해지는 경우도 있다. “권한이 없으면 alert() 띄우고 버튼 비활성화”처럼 클라이언트(자바스크립트) 쪽에서만 검증을 하거나 중요 버튼을 HTML 주석 처리, CSS로 `display:none;`만 적용해 감춰놓고 “권한 제한”이라고 생각하는 경우, 소스 코드를 열어 특정 부분을 수정하면 민감한 정보에 접근할 수 있다. 이를 막기 위해서 권한 체크는 항상 서버에서 수행해야 한다.

### 생각

인증과 인가는 밀접한 관계라 어떤 취약점이 인증 취약점이고, 어떤 취약점이 인가 취약점인지 분류하는데 조금 어려웠다. 중요한건 분류보다, 어떤 취약점들이 있고, 어떻게 막아야 하는지라고 생각한다.

**인증/인가 취약점**에 대해 알아보며, 클라이언트는 항상 위변조에 노출되어있고, 서버에서 항상 클라이언트를 의심하며 검증을 해야한다는 것을 느꼈다. 물론, 클라이언트의 보안을 신경쓰지 말자는 말은 아니다. 다만, 막상 알아보니 클라이언트 위변조가 생각보다 쉬워서 조금 경각심을 갖게 되었다.


## 2. 입력값 검증 부족 (XSS, SQL Injection 등)
이건 내일 합시다